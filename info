decompiled source from gothaj 3.0 its readable but not 100% sure
